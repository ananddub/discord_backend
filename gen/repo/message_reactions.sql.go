// Code generated by sqlc. DO NOT EDIT.
// versions:
//   sqlc v1.30.0
// source: message_reactions.sql

package repo

import (
	"context"

	"github.com/jackc/pgx/v5/pgtype"
)

const countReactions = `-- name: CountReactions :one
SELECT emoji, COUNT(*) as count
FROM message_reactions
WHERE
    message_id = $1
GROUP BY
    emoji
`

type CountReactionsRow struct {
	Emoji string `json:"emoji"`
	Count int64  `json:"count"`
}

func (q *Queries) CountReactions(ctx context.Context, messageID int32) (CountReactionsRow, error) {
	row := q.db.QueryRow(ctx, countReactions, messageID)
	var i CountReactionsRow
	err := row.Scan(&i.Emoji, &i.Count)
	return i, err
}

const createReaction = `-- name: CreateReaction :one
INSERT INTO
    message_reactions (
        message_id,
        user_id,
        emoji,
        emoji_id
    )
VALUES ($1, $2, $3, $4)
RETURNING
    id, message_id, user_id, emoji, emoji_id, created_at
`

type CreateReactionParams struct {
	MessageID int32       `json:"message_id"`
	UserID    int32       `json:"user_id"`
	Emoji     string      `json:"emoji"`
	EmojiID   pgtype.Text `json:"emoji_id"`
}

func (q *Queries) CreateReaction(ctx context.Context, arg CreateReactionParams) (MessageReaction, error) {
	row := q.db.QueryRow(ctx, createReaction,
		arg.MessageID,
		arg.UserID,
		arg.Emoji,
		arg.EmojiID,
	)
	var i MessageReaction
	err := row.Scan(
		&i.ID,
		&i.MessageID,
		&i.UserID,
		&i.Emoji,
		&i.EmojiID,
		&i.CreatedAt,
	)
	return i, err
}

const deleteAllReactions = `-- name: DeleteAllReactions :one
DELETE FROM message_reactions WHERE message_id = $1 RETURNING id, message_id, user_id, emoji, emoji_id, created_at
`

func (q *Queries) DeleteAllReactions(ctx context.Context, messageID int32) (MessageReaction, error) {
	row := q.db.QueryRow(ctx, deleteAllReactions, messageID)
	var i MessageReaction
	err := row.Scan(
		&i.ID,
		&i.MessageID,
		&i.UserID,
		&i.Emoji,
		&i.EmojiID,
		&i.CreatedAt,
	)
	return i, err
}

const deleteReaction = `-- name: DeleteReaction :one
DELETE FROM message_reactions
WHERE
    message_id = $1
    AND user_id = $2
    AND emoji = $3
RETURNING
    id, message_id, user_id, emoji, emoji_id, created_at
`

type DeleteReactionParams struct {
	MessageID int32  `json:"message_id"`
	UserID    int32  `json:"user_id"`
	Emoji     string `json:"emoji"`
}

func (q *Queries) DeleteReaction(ctx context.Context, arg DeleteReactionParams) (MessageReaction, error) {
	row := q.db.QueryRow(ctx, deleteReaction, arg.MessageID, arg.UserID, arg.Emoji)
	var i MessageReaction
	err := row.Scan(
		&i.ID,
		&i.MessageID,
		&i.UserID,
		&i.Emoji,
		&i.EmojiID,
		&i.CreatedAt,
	)
	return i, err
}

const getMessageReactions = `-- name: GetMessageReactions :many
SELECT id, message_id, user_id, emoji, emoji_id, created_at FROM message_reactions WHERE message_id = $1
`

func (q *Queries) GetMessageReactions(ctx context.Context, messageID int32) ([]MessageReaction, error) {
	rows, err := q.db.Query(ctx, getMessageReactions, messageID)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []MessageReaction
	for rows.Next() {
		var i MessageReaction
		if err := rows.Scan(
			&i.ID,
			&i.MessageID,
			&i.UserID,
			&i.Emoji,
			&i.EmojiID,
			&i.CreatedAt,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const getReactionsByEmoji = `-- name: GetReactionsByEmoji :many
SELECT id, message_id, user_id, emoji, emoji_id, created_at FROM message_reactions WHERE message_id = $1 AND emoji = $2
`

type GetReactionsByEmojiParams struct {
	MessageID int32  `json:"message_id"`
	Emoji     string `json:"emoji"`
}

func (q *Queries) GetReactionsByEmoji(ctx context.Context, arg GetReactionsByEmojiParams) ([]MessageReaction, error) {
	rows, err := q.db.Query(ctx, getReactionsByEmoji, arg.MessageID, arg.Emoji)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []MessageReaction
	for rows.Next() {
		var i MessageReaction
		if err := rows.Scan(
			&i.ID,
			&i.MessageID,
			&i.UserID,
			&i.Emoji,
			&i.EmojiID,
			&i.CreatedAt,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}
