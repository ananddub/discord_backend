// Code generated by sqlc. DO NOT EDIT.
// versions:
//   sqlc v1.30.0
// source: message_attachments.sql

package repo

import (
	"context"

	"github.com/jackc/pgx/v5/pgtype"
)

const createMessageAttachment = `-- name: CreateMessageAttachment :one
INSERT INTO message_attachments (
    message_id, file_url, file_name, file_type, file_size, width, height
) VALUES (
    $1, $2, $3, $4, $5, $6, $7
) RETURNING id, message_id, file_url, file_name, file_type, file_size, width, height, is_deleted, created_at
`

type CreateMessageAttachmentParams struct {
	MessageID int32       `json:"message_id"`
	FileUrl   string      `json:"file_url"`
	FileName  string      `json:"file_name"`
	FileType  string      `json:"file_type"`
	FileSize  int64       `json:"file_size"`
	Width     pgtype.Int4 `json:"width"`
	Height    pgtype.Int4 `json:"height"`
}

func (q *Queries) CreateMessageAttachment(ctx context.Context, arg CreateMessageAttachmentParams) (MessageAttachment, error) {
	row := q.db.QueryRow(ctx, createMessageAttachment,
		arg.MessageID,
		arg.FileUrl,
		arg.FileName,
		arg.FileType,
		arg.FileSize,
		arg.Width,
		arg.Height,
	)
	var i MessageAttachment
	err := row.Scan(
		&i.ID,
		&i.MessageID,
		&i.FileUrl,
		&i.FileName,
		&i.FileType,
		&i.FileSize,
		&i.Width,
		&i.Height,
		&i.IsDeleted,
		&i.CreatedAt,
	)
	return i, err
}

const getMessageAttachments = `-- name: GetMessageAttachments :many
SELECT id, message_id, file_url, file_name, file_type, file_size, width, height, is_deleted, created_at FROM message_attachments
WHERE message_id = $1 AND is_deleted = FALSE
`

func (q *Queries) GetMessageAttachments(ctx context.Context, messageID int32) ([]MessageAttachment, error) {
	rows, err := q.db.Query(ctx, getMessageAttachments, messageID)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []MessageAttachment
	for rows.Next() {
		var i MessageAttachment
		if err := rows.Scan(
			&i.ID,
			&i.MessageID,
			&i.FileUrl,
			&i.FileName,
			&i.FileType,
			&i.FileSize,
			&i.Width,
			&i.Height,
			&i.IsDeleted,
			&i.CreatedAt,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const hardDeleteMessageAttachment = `-- name: HardDeleteMessageAttachment :exec
DELETE FROM message_attachments
WHERE id = $1
`

func (q *Queries) HardDeleteMessageAttachment(ctx context.Context, id int32) error {
	_, err := q.db.Exec(ctx, hardDeleteMessageAttachment, id)
	return err
}

const hardDeleteMessageAttachments = `-- name: HardDeleteMessageAttachments :exec
DELETE FROM message_attachments
WHERE message_id = $1
`

func (q *Queries) HardDeleteMessageAttachments(ctx context.Context, messageID int32) error {
	_, err := q.db.Exec(ctx, hardDeleteMessageAttachments, messageID)
	return err
}

const restoreMessageAttachment = `-- name: RestoreMessageAttachment :exec
UPDATE message_attachments
SET is_deleted = FALSE, updated_at = CURRENT_TIMESTAMP
WHERE id = $1
`

func (q *Queries) RestoreMessageAttachment(ctx context.Context, id int32) error {
	_, err := q.db.Exec(ctx, restoreMessageAttachment, id)
	return err
}

const softDeleteMessageAttachment = `-- name: SoftDeleteMessageAttachment :exec
UPDATE message_attachments
SET is_deleted = TRUE, updated_at = CURRENT_TIMESTAMP
WHERE id = $1
`

func (q *Queries) SoftDeleteMessageAttachment(ctx context.Context, id int32) error {
	_, err := q.db.Exec(ctx, softDeleteMessageAttachment, id)
	return err
}

const softDeleteMessageAttachments = `-- name: SoftDeleteMessageAttachments :exec
UPDATE message_attachments
SET is_deleted = TRUE, updated_at = CURRENT_TIMESTAMP
WHERE message_id = $1
`

func (q *Queries) SoftDeleteMessageAttachments(ctx context.Context, messageID int32) error {
	_, err := q.db.Exec(ctx, softDeleteMessageAttachments, messageID)
	return err
}
