// Code generated by sqlc. DO NOT EDIT.
// versions:
//   sqlc v1.30.0
// source: friends.sql

package repo

import (
	"context"

	"github.com/jackc/pgx/v5/pgtype"
)

const blockUser = `-- name: BlockUser :exec
UPDATE friends
SET status = 'blocked', updated_at = CURRENT_TIMESTAMP
WHERE user_id = $1 AND friend_id = $2 AND is_deleted = FALSE
`

type BlockUserParams struct {
	UserID   int32 `json:"user_id"`
	FriendID int32 `json:"friend_id"`
}

func (q *Queries) BlockUser(ctx context.Context, arg BlockUserParams) error {
	_, err := q.db.Exec(ctx, blockUser, arg.UserID, arg.FriendID)
	return err
}

const createFriend = `-- name: CreateFriend :one
INSERT INTO friends (
    user_id, friend_id, status
) VALUES (
    $1, $2, $3
) RETURNING id, user_id, friend_id, status, alias_name, is_favorite, is_deleted, created_at, updated_at
`

type CreateFriendParams struct {
	UserID   int32  `json:"user_id"`
	FriendID int32  `json:"friend_id"`
	Status   string `json:"status"`
}

func (q *Queries) CreateFriend(ctx context.Context, arg CreateFriendParams) (Friend, error) {
	row := q.db.QueryRow(ctx, createFriend, arg.UserID, arg.FriendID, arg.Status)
	var i Friend
	err := row.Scan(
		&i.ID,
		&i.UserID,
		&i.FriendID,
		&i.Status,
		&i.AliasName,
		&i.IsFavorite,
		&i.IsDeleted,
		&i.CreatedAt,
		&i.UpdatedAt,
	)
	return i, err
}

const getBlockedUsers = `-- name: GetBlockedUsers :many
SELECT id, user_id, friend_id, status, alias_name, is_favorite, is_deleted, created_at, updated_at FROM friends
WHERE user_id = $1 AND status = 'blocked'
`

func (q *Queries) GetBlockedUsers(ctx context.Context, userID int32) ([]Friend, error) {
	rows, err := q.db.Query(ctx, getBlockedUsers, userID)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []Friend
	for rows.Next() {
		var i Friend
		if err := rows.Scan(
			&i.ID,
			&i.UserID,
			&i.FriendID,
			&i.Status,
			&i.AliasName,
			&i.IsFavorite,
			&i.IsDeleted,
			&i.CreatedAt,
			&i.UpdatedAt,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const getFriendship = `-- name: GetFriendship :one
SELECT id, user_id, friend_id, status, alias_name, is_favorite, is_deleted, created_at, updated_at FROM friends
WHERE user_id = $1 AND friend_id = $2 AND is_deleted = FALSE LIMIT 1
`

type GetFriendshipParams struct {
	UserID   int32 `json:"user_id"`
	FriendID int32 `json:"friend_id"`
}

func (q *Queries) GetFriendship(ctx context.Context, arg GetFriendshipParams) (Friend, error) {
	row := q.db.QueryRow(ctx, getFriendship, arg.UserID, arg.FriendID)
	var i Friend
	err := row.Scan(
		&i.ID,
		&i.UserID,
		&i.FriendID,
		&i.Status,
		&i.AliasName,
		&i.IsFavorite,
		&i.IsDeleted,
		&i.CreatedAt,
		&i.UpdatedAt,
	)
	return i, err
}

const getPendingFriendRequests = `-- name: GetPendingFriendRequests :many
SELECT id, user_id, friend_id, status, alias_name, is_favorite, is_deleted, created_at, updated_at FROM friends
WHERE friend_id = $1 AND status = 'pending' AND is_deleted = FALSE
ORDER BY created_at DESC
`

func (q *Queries) GetPendingFriendRequests(ctx context.Context, friendID int32) ([]Friend, error) {
	rows, err := q.db.Query(ctx, getPendingFriendRequests, friendID)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []Friend
	for rows.Next() {
		var i Friend
		if err := rows.Scan(
			&i.ID,
			&i.UserID,
			&i.FriendID,
			&i.Status,
			&i.AliasName,
			&i.IsFavorite,
			&i.IsDeleted,
			&i.CreatedAt,
			&i.UpdatedAt,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const getSentFriendRequests = `-- name: GetSentFriendRequests :many
SELECT id, user_id, friend_id, status, alias_name, is_favorite, is_deleted, created_at, updated_at FROM friends
WHERE user_id = $1 AND status = 'pending' AND is_deleted = FALSE
ORDER BY created_at DESC
`

func (q *Queries) GetSentFriendRequests(ctx context.Context, userID int32) ([]Friend, error) {
	rows, err := q.db.Query(ctx, getSentFriendRequests, userID)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []Friend
	for rows.Next() {
		var i Friend
		if err := rows.Scan(
			&i.ID,
			&i.UserID,
			&i.FriendID,
			&i.Status,
			&i.AliasName,
			&i.IsFavorite,
			&i.IsDeleted,
			&i.CreatedAt,
			&i.UpdatedAt,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const getUserFriends = `-- name: GetUserFriends :many
SELECT id, user_id, friend_id, status, alias_name, is_favorite, is_deleted, created_at, updated_at FROM friends
WHERE user_id = $1 AND status = 'accepted' AND is_deleted = FALSE
ORDER BY created_at DESC
`

func (q *Queries) GetUserFriends(ctx context.Context, userID int32) ([]Friend, error) {
	rows, err := q.db.Query(ctx, getUserFriends, userID)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []Friend
	for rows.Next() {
		var i Friend
		if err := rows.Scan(
			&i.ID,
			&i.UserID,
			&i.FriendID,
			&i.Status,
			&i.AliasName,
			&i.IsFavorite,
			&i.IsDeleted,
			&i.CreatedAt,
			&i.UpdatedAt,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const hardDeleteFriendship = `-- name: HardDeleteFriendship :exec
DELETE FROM friends
WHERE (user_id = $1 AND friend_id = $2) OR (user_id = $2 AND friend_id = $1)
`

type HardDeleteFriendshipParams struct {
	UserID   int32 `json:"user_id"`
	FriendID int32 `json:"friend_id"`
}

func (q *Queries) HardDeleteFriendship(ctx context.Context, arg HardDeleteFriendshipParams) error {
	_, err := q.db.Exec(ctx, hardDeleteFriendship, arg.UserID, arg.FriendID)
	return err
}

const restoreFriendship = `-- name: RestoreFriendship :exec
UPDATE friends
SET is_deleted = FALSE, updated_at = CURRENT_TIMESTAMP
WHERE user_id = $1 AND friend_id = $2
`

type RestoreFriendshipParams struct {
	UserID   int32 `json:"user_id"`
	FriendID int32 `json:"friend_id"`
}

func (q *Queries) RestoreFriendship(ctx context.Context, arg RestoreFriendshipParams) error {
	_, err := q.db.Exec(ctx, restoreFriendship, arg.UserID, arg.FriendID)
	return err
}

const softDeleteFriendship = `-- name: SoftDeleteFriendship :exec
UPDATE friends
SET is_deleted = TRUE, updated_at = CURRENT_TIMESTAMP
WHERE (user_id = $1 AND friend_id = $2) OR (user_id = $2 AND friend_id = $1)
`

type SoftDeleteFriendshipParams struct {
	UserID   int32 `json:"user_id"`
	FriendID int32 `json:"friend_id"`
}

func (q *Queries) SoftDeleteFriendship(ctx context.Context, arg SoftDeleteFriendshipParams) error {
	_, err := q.db.Exec(ctx, softDeleteFriendship, arg.UserID, arg.FriendID)
	return err
}

const toggleFavorite = `-- name: ToggleFavorite :exec
UPDATE friends
SET is_favorite = $3, updated_at = CURRENT_TIMESTAMP
WHERE user_id = $1 AND friend_id = $2 AND is_deleted = FALSE
`

type ToggleFavoriteParams struct {
	UserID     int32       `json:"user_id"`
	FriendID   int32       `json:"friend_id"`
	IsFavorite pgtype.Bool `json:"is_favorite"`
}

func (q *Queries) ToggleFavorite(ctx context.Context, arg ToggleFavoriteParams) error {
	_, err := q.db.Exec(ctx, toggleFavorite, arg.UserID, arg.FriendID, arg.IsFavorite)
	return err
}

const updateFriendAlias = `-- name: UpdateFriendAlias :exec
UPDATE friends
SET alias_name = $3, updated_at = CURRENT_TIMESTAMP
WHERE user_id = $1 AND friend_id = $2 AND is_deleted = FALSE
`

type UpdateFriendAliasParams struct {
	UserID    int32       `json:"user_id"`
	FriendID  int32       `json:"friend_id"`
	AliasName pgtype.Text `json:"alias_name"`
}

func (q *Queries) UpdateFriendAlias(ctx context.Context, arg UpdateFriendAliasParams) error {
	_, err := q.db.Exec(ctx, updateFriendAlias, arg.UserID, arg.FriendID, arg.AliasName)
	return err
}

const updateFriendStatus = `-- name: UpdateFriendStatus :exec
UPDATE friends
SET status = $3, updated_at = CURRENT_TIMESTAMP
WHERE user_id = $1 AND friend_id = $2 AND is_deleted = FALSE
`

type UpdateFriendStatusParams struct {
	UserID   int32  `json:"user_id"`
	FriendID int32  `json:"friend_id"`
	Status   string `json:"status"`
}

func (q *Queries) UpdateFriendStatus(ctx context.Context, arg UpdateFriendStatusParams) error {
	_, err := q.db.Exec(ctx, updateFriendStatus, arg.UserID, arg.FriendID, arg.Status)
	return err
}
