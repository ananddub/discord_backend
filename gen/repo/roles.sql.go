// Code generated by sqlc. DO NOT EDIT.
// versions:
//   sqlc v1.30.0
// source: roles.sql

package repo

import (
	"context"

	"github.com/jackc/pgx/v5/pgtype"
)

const createRole = `-- name: CreateRole :one
INSERT INTO
    roles (
        server_id,
        name,
        color,
        hoist,
        position,
        permissions,
        mentionable,
        description
    )
VALUES (
        $1,
        $2,
        $3,
        $4,
        $5,
        $6,
        $7,
        $8
    )
RETURNING
    id, server_id, name, color, hoist, position, permissions, mentionable, icon, description, is_default, is_deleted, created_at, updated_at
`

type CreateRoleParams struct {
	ServerID    int32       `json:"server_id"`
	Name        string      `json:"name"`
	Color       pgtype.Text `json:"color"`
	Hoist       pgtype.Bool `json:"hoist"`
	Position    pgtype.Int4 `json:"position"`
	Permissions pgtype.Int8 `json:"permissions"`
	Mentionable pgtype.Bool `json:"mentionable"`
	Description pgtype.Text `json:"description"`
}

func (q *Queries) CreateRole(ctx context.Context, arg CreateRoleParams) (Role, error) {
	row := q.db.QueryRow(ctx, createRole,
		arg.ServerID,
		arg.Name,
		arg.Color,
		arg.Hoist,
		arg.Position,
		arg.Permissions,
		arg.Mentionable,
		arg.Description,
	)
	var i Role
	err := row.Scan(
		&i.ID,
		&i.ServerID,
		&i.Name,
		&i.Color,
		&i.Hoist,
		&i.Position,
		&i.Permissions,
		&i.Mentionable,
		&i.Icon,
		&i.Description,
		&i.IsDefault,
		&i.IsDeleted,
		&i.CreatedAt,
		&i.UpdatedAt,
	)
	return i, err
}

const getRoleByID = `-- name: GetRoleByID :one
SELECT id, server_id, name, color, hoist, position, permissions, mentionable, icon, description, is_default, is_deleted, created_at, updated_at FROM roles WHERE id = $1 AND is_deleted = FALSE LIMIT 1
`

func (q *Queries) GetRoleByID(ctx context.Context, id int32) (Role, error) {
	row := q.db.QueryRow(ctx, getRoleByID, id)
	var i Role
	err := row.Scan(
		&i.ID,
		&i.ServerID,
		&i.Name,
		&i.Color,
		&i.Hoist,
		&i.Position,
		&i.Permissions,
		&i.Mentionable,
		&i.Icon,
		&i.Description,
		&i.IsDefault,
		&i.IsDeleted,
		&i.CreatedAt,
		&i.UpdatedAt,
	)
	return i, err
}

const getServerRoles = `-- name: GetServerRoles :many
SELECT id, server_id, name, color, hoist, position, permissions, mentionable, icon, description, is_default, is_deleted, created_at, updated_at
FROM roles
WHERE
    server_id = $1
    AND is_deleted = FALSE
ORDER BY position DESC
`

func (q *Queries) GetServerRoles(ctx context.Context, serverID int32) ([]Role, error) {
	rows, err := q.db.Query(ctx, getServerRoles, serverID)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []Role
	for rows.Next() {
		var i Role
		if err := rows.Scan(
			&i.ID,
			&i.ServerID,
			&i.Name,
			&i.Color,
			&i.Hoist,
			&i.Position,
			&i.Permissions,
			&i.Mentionable,
			&i.Icon,
			&i.Description,
			&i.IsDefault,
			&i.IsDeleted,
			&i.CreatedAt,
			&i.UpdatedAt,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const hardDeleteRole = `-- name: HardDeleteRole :one
DELETE FROM roles WHERE id = $1 RETURNING id, server_id, name, color, hoist, position, permissions, mentionable, icon, description, is_default, is_deleted, created_at, updated_at
`

func (q *Queries) HardDeleteRole(ctx context.Context, id int32) (Role, error) {
	row := q.db.QueryRow(ctx, hardDeleteRole, id)
	var i Role
	err := row.Scan(
		&i.ID,
		&i.ServerID,
		&i.Name,
		&i.Color,
		&i.Hoist,
		&i.Position,
		&i.Permissions,
		&i.Mentionable,
		&i.Icon,
		&i.Description,
		&i.IsDefault,
		&i.IsDeleted,
		&i.CreatedAt,
		&i.UpdatedAt,
	)
	return i, err
}

const restoreRole = `-- name: RestoreRole :one
UPDATE roles
SET
    is_deleted = FALSE,
    updated_at = CURRENT_TIMESTAMP
WHERE
    id = $1
RETURNING
    id, server_id, name, color, hoist, position, permissions, mentionable, icon, description, is_default, is_deleted, created_at, updated_at
`

func (q *Queries) RestoreRole(ctx context.Context, id int32) (Role, error) {
	row := q.db.QueryRow(ctx, restoreRole, id)
	var i Role
	err := row.Scan(
		&i.ID,
		&i.ServerID,
		&i.Name,
		&i.Color,
		&i.Hoist,
		&i.Position,
		&i.Permissions,
		&i.Mentionable,
		&i.Icon,
		&i.Description,
		&i.IsDefault,
		&i.IsDeleted,
		&i.CreatedAt,
		&i.UpdatedAt,
	)
	return i, err
}

const softDeleteRole = `-- name: SoftDeleteRole :one
UPDATE roles
SET
    is_deleted = TRUE,
    updated_at = CURRENT_TIMESTAMP
WHERE
    id = $1
RETURNING
    id, server_id, name, color, hoist, position, permissions, mentionable, icon, description, is_default, is_deleted, created_at, updated_at
`

func (q *Queries) SoftDeleteRole(ctx context.Context, id int32) (Role, error) {
	row := q.db.QueryRow(ctx, softDeleteRole, id)
	var i Role
	err := row.Scan(
		&i.ID,
		&i.ServerID,
		&i.Name,
		&i.Color,
		&i.Hoist,
		&i.Position,
		&i.Permissions,
		&i.Mentionable,
		&i.Icon,
		&i.Description,
		&i.IsDefault,
		&i.IsDeleted,
		&i.CreatedAt,
		&i.UpdatedAt,
	)
	return i, err
}

const updateRole = `-- name: UpdateRole :one
UPDATE roles
SET
    name = COALESCE($1, name),
    color = COALESCE($2, color),
    hoist = COALESCE($3, hoist),
    position = COALESCE(
        $4,
        position
    ),
    permissions = COALESCE(
        $5,
        permissions
    ),
    mentionable = COALESCE(
        $6,
        mentionable
    ),
    description = COALESCE(
        $7,
        description
    ),
    updated_at = CURRENT_TIMESTAMP
WHERE
    id = $8
    AND is_deleted = FALSE
RETURNING
    id, server_id, name, color, hoist, position, permissions, mentionable, icon, description, is_default, is_deleted, created_at, updated_at
`

type UpdateRoleParams struct {
	Name        pgtype.Text `json:"name"`
	Color       pgtype.Text `json:"color"`
	Hoist       pgtype.Bool `json:"hoist"`
	Position    pgtype.Int4 `json:"position"`
	Permissions pgtype.Int8 `json:"permissions"`
	Mentionable pgtype.Bool `json:"mentionable"`
	Description pgtype.Text `json:"description"`
	ID          int32       `json:"id"`
}

func (q *Queries) UpdateRole(ctx context.Context, arg UpdateRoleParams) (Role, error) {
	row := q.db.QueryRow(ctx, updateRole,
		arg.Name,
		arg.Color,
		arg.Hoist,
		arg.Position,
		arg.Permissions,
		arg.Mentionable,
		arg.Description,
		arg.ID,
	)
	var i Role
	err := row.Scan(
		&i.ID,
		&i.ServerID,
		&i.Name,
		&i.Color,
		&i.Hoist,
		&i.Position,
		&i.Permissions,
		&i.Mentionable,
		&i.Icon,
		&i.Description,
		&i.IsDefault,
		&i.IsDeleted,
		&i.CreatedAt,
		&i.UpdatedAt,
	)
	return i, err
}

const updateRolePosition = `-- name: UpdateRolePosition :one
UPDATE roles
SET
    position = $2,
    updated_at = CURRENT_TIMESTAMP
WHERE
    id = $1
    AND is_deleted = FALSE
RETURNING
    id, server_id, name, color, hoist, position, permissions, mentionable, icon, description, is_default, is_deleted, created_at, updated_at
`

type UpdateRolePositionParams struct {
	ID       int32       `json:"id"`
	Position pgtype.Int4 `json:"position"`
}

func (q *Queries) UpdateRolePosition(ctx context.Context, arg UpdateRolePositionParams) (Role, error) {
	row := q.db.QueryRow(ctx, updateRolePosition, arg.ID, arg.Position)
	var i Role
	err := row.Scan(
		&i.ID,
		&i.ServerID,
		&i.Name,
		&i.Color,
		&i.Hoist,
		&i.Position,
		&i.Permissions,
		&i.Mentionable,
		&i.Icon,
		&i.Description,
		&i.IsDefault,
		&i.IsDeleted,
		&i.CreatedAt,
		&i.UpdatedAt,
	)
	return i, err
}
